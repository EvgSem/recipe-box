<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Show Recipe-box</title>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
</head>
<body onload="loadPage()">
    <h1 id="recipeName">Edit recipe-box</h1>
    <label for="name">Name</label>
    <input type="text" id="name"/>
    <button id = ="save">Save</button>
<script>
    function loadPage (){
        var recipeID = location.search.split('id=')[1];
        let promise = new Promise(function(resolve) {
            console.log("here1");
            $.ajax({
                url: 'http://localhost:3000/recipe?id=' + recipeID,
                type: 'GET',
                success: function(result){
                    data=result;
                    console.log("here2");
                    resolve(data);
                }
            });
        });
        promise.then(function(recipe){
            console.log("ad");
           document.getElementById("name").value = recipe.name;
        });
        $("button").click(function(){
            let newName = document.getElementById("name").value;
            $.ajax({
                url: '/editRecipe',
                type: 'POST',
                data: JSON.stringify({'id':recipeID, 'name':newName}),
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: function (resp) {
                    console.log("s!!!!!!!!!!!");
                },
                error: function (error) {
                    console.log(error);
                }
            });
            window.location.href='/showRecipe.html?id=' + recipeID;
        });
    };
</script>
</body>
</html>